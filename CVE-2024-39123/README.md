# CVE-2024-39123: Stored XSS in Calibre-Web

A stored cross-site scripting (XSS) vulnerability in Calibre-Web 0.6.21 and earlier may allow a
remote attacker to execute arbitrary JavaScript in the web browser of a victim by injecting a malicious payload into
the book description field.


## Proof of Concept

- Log in to the application.
- Upload a new book.
- Access the Books List functionality from the `/table?data=list&sort_param=stored` endpoint.
- In the `Comments` field, input the following payload:

    `<a href=javas%1Bcript:alert()>Hello there!</a>`

- Save the changes.
- Upon clicking the description on the book that was created, in the Book Details, the payload was successfully injected in the Description field. By clicking on the message, an alert box will appear, indicating the execution of the injected script.

Discovered by Catalin Iovita & Alexandru Postolache, June 2024.

References:

- https://www.cve.org/CVERecord?id=CVE-2024-39123
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39123
